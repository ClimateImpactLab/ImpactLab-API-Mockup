# LaTech

Prototype package for distributed, math-syntax-aware computing

## Contributing

This example is flashy, but the package needs a lot of work. Issues, PRs, and feature requests are welcome!


## Example

Initialize the API

    >>> api = ClimateImpactLabDataAPI()

Load variables

  	>>> alpha = api.get_variable('alpha')	
    >>> gamma1 = api.get_variable('gamma1') 
    >>> gamma2 = api.get_variable('gamma2') 
  	>>> gamma3 = api.get_variable('gamma3')	
  	
  	>>> avg_days_per_bin = api.get_variable('avg_days_per_bin')	
    >>> gdppc = api.get_variable('gdppc') 
    >>> popdens = api.get_variable('popdens')

  	>>> temp = api.get_variable('temp')	


Do math

  	>>> betahat = alpha + gamma1*avg_days_per_bin + gamma2*(gdppc.ln()) + gamma3*(popdens.ln())

Set the symbols for new variables, and display:

  	>>> betahat.attrs['symbol'] = '\\hat{{\\beta}}'
  	>>> betahat.equation()

    \hat{{\beta}}_{bins,adm2,time} = \alpha_{bins} + \left({{\gamma_1}}_{bins}\right)\left(AvgDaysPerBin_{bins,adm2,time}\right) + \left({{\gamma_2}}_{bins}\right)\left(\ln{\left(GdpPC_{adm2,time}\right)}\right) + \left({{\gamma_3}}_{bins}\right)\left(\ln{\left(PopDensity_{adm2,time}\right)}\right)


Also, do the computation:

  	>>> betahat.compute()

    <xarray.DataArray (bins: 12, adm2: 24999, time: 100)>
    array([[[ 0.87416235,  1.05377146,  0.62176841, ..., -0.1349435 ,
          1.0587251 ,  0.95604877],
        [ 0.51502525,  0.70730208,  1.35129828, ...,  1.17546459,
          0.80187333,  1.33690548],
        [ 0.47198842,  1.11953911,  0.75744806, ...,  0.38920108,
          0.61235945,  0.59058538],
        ..., 
        [ 0.67781791,  0.61104701,  1.02276373, ...,  0.64545257,
          0.47680262,  0.21278124],
        [ 0.49718042,  0.01821387,  0.33770017, ...,  0.70981755,
          0.66196066,  1.34269473],
        [-0.73909752,  0.35220569, -0.48610563, ..., -0.0606268 ,
          0.6436611 , -0.12547351]],

       [[ 0.04269732, -0.03410991,  0.02518116, ..., -0.93335475,
          0.02807987,  0.13909437],
        [-0.67826971, -0.09452781,  0.2288688 , ..., -0.11221717,
         -0.52041712,  0.21837157],
        [-0.50524543, -0.04663531, -0.24733629, ..., -0.65330024,
         -0.36553483, -0.34307005],
        ..., 
        [-0.27727722, -0.03175857, -0.11227961, ..., -0.52312908,
         -0.27962866, -0.82682022],
        [-0.41804262, -0.7543012 , -0.96541456, ..., -0.56700067,
         -0.15972641,  0.13117137],
        [-1.61876152, -0.30704312, -1.1984259 , ..., -1.15593852,
         -0.34344089, -1.41655715]],

       [[ 0.88698419,  1.09362998,  0.67131533, ..., -0.723775  ,
          1.1596118 ,  1.22402066],
        [-0.19880103,  0.50298855,  0.63938569, ...,  0.58778998,
         -0.04901212,  0.90841688],
        [-0.20203033,  0.92124711,  0.34896713, ..., -0.16251875,
         -0.06051511,  0.19246625],
        ..., 
        [ 0.7616392 ,  0.67052418,  0.87369255, ..., -0.1349792 ,
          0.2502902 , -0.41386483],
        [ 0.29043362, -0.22198607, -0.73392622, ..., -0.01691445,
          0.27121384,  1.14329668],
        [-1.37752509,  0.20060462, -1.16147813, ..., -0.27834271,
          0.78809657, -0.61587345]],

       ..., 
       [[-0.43785911, -0.28273852, -0.29178652, ..., -2.3567064 ,
         -0.20161107,  0.25075125],
        [-1.67637349, -0.52402884,  0.22866696, ..., -0.47116504,
         -1.06665267,  0.14644421],
        [-1.44784688, -0.68871685, -0.95019854, ..., -1.57362898,
         -0.89220203, -0.73398032],
        ..., 
        [-0.62547037, -0.40735947, -0.59025323, ..., -1.36101223,
         -0.57410026, -1.33777621],
        [-1.48168562, -1.64243196, -2.0001654 , ..., -1.21502132,
         -0.61153764,  0.07109543],
        [-2.7031589 , -1.19044798, -2.53896555, ..., -2.94939501,
         -0.64561283, -2.87427763]],

       [[ 0.84296102,  0.94822872,  0.69206233, ..., -0.09967477,
          0.74164423,  1.2054758 ],
        [ 0.20861647,  0.85748323,  0.75207982, ...,  0.57328685,
          0.30700129,  0.82976201],
        [ 0.0601425 ,  0.53615097,  0.74654783, ...,  0.23260902,
          0.26776448,  0.78282656],
        ..., 
        [ 0.44936308,  0.72232052,  0.7497518 , ...,  0.62782146,
          0.8326546 ,  0.10079661],
        [ 0.13418342,  0.42402867, -0.16279178, ...,  0.28599387,
          0.45494102,  0.95437661],
        [-0.37138999,  0.49874506, -0.24884582, ..., -0.66173067,
          0.55844568, -0.36343592]],

       [[ 0.09477287, -0.2962288 , -0.11683216, ..., -2.45570402,
          0.60981473,  0.06263858],
        [-1.73965484, -0.2244844 ,  0.7689654 , ..., -0.34544604,
         -0.23832036,  0.35151619],
        [-2.01953017, -0.05639229, -0.54689661, ..., -0.75902053,
         -0.46980689, -0.2345844 ],
        ..., 
        [-0.09946229, -0.1318977 , -0.64810747, ..., -0.44200208,
          0.33257907, -0.9921266 ],
        [-1.4762957 , -1.43811251, -1.74836636, ..., -0.71465685,
         -0.55779183,  0.54595349],
        [-1.55107439, -1.01325549, -1.22811184, ..., -3.21694782,
         -0.12382266, -2.40056701]]])
    Coordinates:
      * bins     (bins) int64 0 1 2 3 4 5 6 7 8 9 10 11
      * adm2     (adm2) int64 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ...
      * time     (time) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ...
    Attributes:
        symbol: \hat{{\beta}}

let's simplify betahat's latex:

  	>>> betahat.symbolic = betahat.get_symbol()

now we compute mortality...
  	
    >>> mortality = (betahat*temp).sum(dim='bins')
  	>>> mortality.attrs['symbol'] = 'M'

Note how the mortality subscripts are automatically lower dimension

  	>>> mortality.equation()

    M_{adm2,time} = \sum_{bins}{\left\{\left(\hat{{\beta}}_{bins,adm2,time}\right)\left(T_{bins,adm2,time}\right)\right\}}


  	>>> mortality.compute()

    <xarray.DataArray (adm2: 24999, time: 100)>
    array([[  2.63133029,   3.18325343,   3.00512231, ...,  -7.68449279,
              3.78071378,   4.99857275],
           [ -1.75912142,   1.90520699,   5.16987421, ...,   2.20188204,
             -0.09578707,   4.36931597],
           [ -3.52731436,   1.44880405,   0.34917566, ...,  -2.24567919,
             -0.4531826 ,   0.54957452],
           ..., 
           [  1.33854379,   2.15387564,   1.35625489, ...,  -1.12995939,
              1.4941601 ,  -2.03101462],
           [ -0.43282287,  -3.66704585,  -2.9512966 , ...,  -1.38187187,
              0.50236551,   4.87105468],
           [ -7.50644176,  -2.28675164,  -7.51252124, ..., -10.09524499,
              2.75289765,  -5.85060847]])
    Coordinates:
      * adm2     (adm2) int64 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ...
      * time     (time) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ...
    Attributes:
        symbol: M

        
## License

MIT Licesnse
